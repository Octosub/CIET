<% if @food.name.present? %>
  <h1><%= @food.name %></h1>
<% else %>
  <h1>Your Scanned Product</h1>
  <div class="d-flex justify-content-center">
    <%= simple_form_for @food, method: "patch" do |f| %>
  <div class="row g-3">
    <div class="col-auto">
      <%= f.input :name, label: false, placeholder: "Enter Product Name" %>
      </div>
      <div class="col-auto">
      <%= f.submit "Add Name", class: "btn btn-primary mb-3" %>
      </div>
  </div>
    <% end %>
    </div>
<% end %>
<div class="pictures-container">
  <% if @food.photos[1].present? %>
    <%= cl_image_tag @food.photos[1].key, height: 300, width: 400, crop: :fill, class: "big-centered-image green-border-image" %>
  <% else %>
    <%= simple_form_for @food, method: "patch", data: {controller: "autosubmit", 'autosubmit-target': "form"} do |f| %>
      <%= f.input :photos, as: :file, label: false, input_html: { multiple: true, data: {action: "input->autosubmit#submitForm"} } %>
    <% end %>
  <% end %>
  <%= cl_image_tag @food.photos[0].key, height: 300, width: 400, crop: :fill, class: "big-centered-image green-border-image" %>
</div>
<h2>You're scanned Item is <%= "not " if !@vegan_boolean %>vegan</h2>
<div class="bar-container">
  <h2>All Ingredients</h2>
  <% if @vegan_flags.present? %>
    <% @vegan_flags.each do |ingredient| %>
      <div class="wide-bar-card red-background" data-controller="extended-infos">
        <div class="toggle-grid">
          <p class="text-wrap"><strong><%= ingredient.strip.capitalize %></strong> is not vegan</p>
          <button class="btn toggler"  data-action="click->extended-infos#revealInfos">&gt;</button>
        </div>
        <div class="d-none extended-infos" data-extended-infos-target="info">
          <%= link_to "Google it!", "http://www.google.com/search?q=#{ingredient}", target: '_blank', class: "btn btn-primary" %>
          <%= link_to "ğŸŒ± Is Vegan", "", class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
    <% (@food.ingredient_list.split(',') - @vegan_flags).each do |ingredient| %>
      <div class="wide-bar-card green-background" data-controller="extended-infos">
        <div class="toggle-grid">
          <p class="text-wrap"><strong><%= ingredient.strip.capitalize %></strong> is vegan</p>
          <button class="btn toggler"  data-action="click->extended-infos#revealInfos">&gt;</button>
        </div>
        <div class="d-none extended-infos" data-extended-infos-target="info">
          <%= link_to "Google it!", "http://www.google.com/search?q=#{ingredient}", target: '_blank', class: "btn btn-primary" %>
          <%= link_to "ğŸ›‘ Not Vegan", "", class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
  <% elsif @vegan_boolean == false %>
    <% @food.ingredient_list.split(',').each do |ingredient| %>
      <div class="wide-bar-card red-background" data-controller="extended-infos">
        <div class="toggle-grid">
          <p class="text-wrap"><strong><%= ingredient.strip.capitalize %></strong> is not vegan</p>
          <button class="btn toggler"  data-action="click->extended-infos#revealInfos">&gt;</button>
        </div>
        <div class="d-none extended-infos" data-extended-infos-target="info">
          <%= link_to "Google it!", "http://www.google.com/search?q=#{ingredient}", target: '_blank', class: "btn btn-primary" %>
          <%= link_to "ğŸŒ± Is Vegan", "", class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
  <% elsif @vegan_flags.nil? || @vegan_boolean == true %>
    <% @food.ingredient_list.split(',').each do |ingredient| %>
      <div class="wide-bar-card green-background" data-controller="extended-infos">
        <div class="toggle-grid">
          <p class="text-wrap"><strong><%= ingredient.strip.capitalize %></strong> is vegan</p>
          <button class="btn toggler"  data-action="click->extended-infos#revealInfos">&gt;</button>
        </div>
        <div class="d-none extended-infos" data-extended-infos-target="info">
          <%= link_to "Google it!", "http://www.google.com/search?q=#{ingredient}", target: '_blank', class: "btn btn-primary" %>
          <%= link_to "ğŸ›‘ Not Vegan", "", class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
